<?xml version="1.0" encoding="UTF-8"?><environment>
<DEV>
	<serverAWS>
	
		<FRONTS>
		
			<instance IP_priv="123.123.123.123" name="dev-web1">
				<region>eu-west-1</region>
				<imageId>ami-59d0e22d</imageId>
				<instanceType>t1.micro</instanceType>
				<keyName>sshkey-gct2</keyName>
				<fwrules>
					<in>
						<fwrule from="all" ports="80,443" protocols="tcp,udp"/>
						<fwrule access="allow" from="all" ref="./environment/global_fwrules/in[@name='SSH']"/>
					</in>
					<out>
						<fwrule access="allow" ports="1521-1531" protocols="tcp,udp" to="§[string-join(./environment/DEV//DBS/instance/@IP_priv,',')]§"/>
					</out>
				</fwrules>
			</instance>
			
			<instance IP_priv="123.123.123.124" name="dev-web2">
				<region>eu-west-1</region>
				<imageId>ami-59d0e22d</imageId>
				<instanceType>t1.micro</instanceType>
				<keyName>sshkey-gct2</keyName>
				<fwrules>
					<in>
						<fwrule from="all" ports="80,443" protocols="tcp,udp"/>
						<fwrule access="allow" from="all" ref="./environment/global_fwrules/in[@name='SSH']"/>
					</in>
				</fwrules>
			</instance>
			
		</FRONTS>
		
		
		<DBS>
		
			<instance IP_priv="123.123.123.125" name="dev-db1">
				<region>eu-west-1</region>
				<imageId>ami-59d0e22d</imageId>
				<instanceType>t1.micro</instanceType>
				<keyName>sshkey-gct2</keyName>
				<fwrules>
					<in>
						<fwrule access="allow" from="§[string-join(./environment/DEV//FRONTS/instance/@IP_priv,',')]§" ports="1521-1531" protocols="tcp,udp"/>
						<fwrule access="allow" from="all" ref="./environment/global_fwrules/in[@name='SSH']"/>
					</in>
				</fwrules>
			</instance>
			
		</DBS>
		
	</serverAWS>
</DEV>	
<REC>
	<serverAWS>
	
		<FRONTS>
		
			<instance IP_priv="123.123.123.123" name="rec-web1">
				<region>eu-west-1</region>
				<imageId>ami-59d0e22d</imageId>
				<instanceType>t1.micro</instanceType>
				<keyName>sshkey-gct2</keyName>
				<fwrules>
					<in>
						<fwrule from="all" ports="80,443" protocols="tcp,udp"/>
						<fwrule access="allow" from="all" ref="./environment/global_fwrules/in[@name='SSH']"/>
					</in>
					<out>
						<fwrule access="allow" ports="1521-1531" protocols="tcp,udp" to="§[string-join(./environment/REC//DBS/instance/@IP_priv,',')]§"/>
					</out>
				</fwrules>
			</instance>
			
			<instance IP_priv="123.123.123.124" name="rec-web2">
				<region>eu-west-1</region>
				<imageId>ami-59d0e22d</imageId>
				<instanceType>t1.micro</instanceType>
				<keyName>sshkey-gct2</keyName>
				<fwrules>
					<in>
						<fwrule from="all" ports="80,443" protocols="tcp,udp"/>
						<fwrule access="allow" from="all" ref="./environment/global_fwrules/in[@name='SSH']"/>
					</in>
				</fwrules>
			</instance>
			
		</FRONTS>
		
		
		<DBS>
		
			<instance IP_priv="123.123.123.125" name="rec-db1">
				<region>eu-west-1</region>
				<imageId>ami-59d0e22d</imageId>
				<instanceType>t1.micro</instanceType>
				<keyName>sshkey-gct2</keyName>
				<fwrules>
					<in>
						<fwrule access="allow" from="§[string-join(./environment/REC//FRONTS/instance/@IP_priv,',')]" ports="1521-1531" protocols="tcp,udp"/>
						<fwrule access="allow" from="all" ref="./environment/global_fwrules/in[@name='SSH']"/>
					</in>
				</fwrules>
			</instance>
			
		</DBS>
		
	</serverAWS>
</REC>	

	<global_fwrules>
		<!-- pour les machines de types linux -->
		<in name="SSH" ports="22" protocols="tcp"/>
		<!-- pour les machines de types windows -->
		<in name="RDP" ports="3389" protocols="tcp"/>
	</global_fwrules>
	
	
</environment>