<?xml version="1.0" encoding="UTF-8"?><environment longname="developpement" shortname="DEV">
	
	<global-fwrules>
		<ssh access="allow" directions="in" from-ips="all" to-ports="22"/>
		<rdp access="allow" directions="in" from-ips="all" to-ports="389"/>
	</global-fwrules>

	<models>
	
		<model image-id="ami-3c5f5748" instance-type="t1.micro" keypair-name="id_rsa_aws_webs" name="model-WEB" region="eu-west-1">
			<network-management method="ssh" port="22" mgmt-network-device-attribute="nat-ip"/>
			<firewall>
				<tcp access="allow" directions="in" from-ips="all" to-ports="80-443"/>
				<tcp herit="./environment/global-fwrules/ssh"/>
				<tcp access="allow" directions="out" to-ips="ยง[string-join(melody:getManagementNetworkHost(//DB//instance),',')]ยง" to-ports="1421"/>
			</firewall>
			<disk-devices>
				<disk delete-on-termination="true" device="/dev/sda1" root-device="true"/>
				<disk delete-on-termination="true" device="/dev/sdb" size="1 G"/>
				<disk delete-on-termination="true" device="/dev/sdc" size="2 G"/>
			</disk-devices>
		</model>
	
		<model image-id="ami-3c5f5748" instance-type="t1.micro" keypair-name="id_rsa_aws_dbs" name="model-DB" region="eu-west-1">
			<network-management method="ssh" port="22" mgmt-network-device-attribute="nat-ip"/>
			<firewall>
				<tcp herit="./environment/global-fwrules/ssh"/>
				<tcp access="allow" directions="in" from-ips="ยง[string-join(melody:getManagementNetworkHost(//WEB//instance),',')]ยง" to-ports="1421"/>
			</firewall>
			<disk-devices>
				<disk delete-on-termination="true" device="/dev/sda1" root-device="true"/>
				<disk delete-on-termination="true" device="/dev/sdb" size="10 G"/>
				<disk delete-on-termination="true" device="/dev/sdc" size="20 G"/>
			</disk-devices>
		</model>
			
	</models>

	<instances>
		<WEB>
			<instance availability-zone="a" herit="./environment/models/model[@name='model-WEB']" name="web-a01">
				<disk-devices>
					<tcp access="allow" directions="in" from-ips="all" to-ports="8080,8443"/>
				</disk-devices>
				<disk-devices>
					<disk delete-on-termination="true" device="/dev/sdd" size="1 G"/>
				</disk-devices>
				<network-devices>
					<interface device-name="eth0"/>
				</network-devices>
			</instance>	
			<instance availability-zone="b" herit="./environment/models/model[@name='model-WEB']" name="web-b01">
				<network-devices>
					<interface device-name="eth0"/>
				</network-devices>
			</instance>	
			<instance availability-zone="c" herit="./environment/models/model[@name='model-WEB']" name="web-c01">
				<network-devices>
					<interface device-name="eth0"/>
				</network-devices>
			</instance>	
		</WEB>
		<DB>
			<instance herit="./environment/models/model[@name='model-DB']" instance-type="m1.small" name="db-01"/>
		</DB>
	</instances>
	
</environment>