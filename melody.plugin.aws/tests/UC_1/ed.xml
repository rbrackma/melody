<?xml version="1.0" encoding="UTF-8"?><environment longname="developpement" shortname="DEV">
	
	<global-fwrules>
		<fwrule access="allow" direction="in" from-ips="all" name="SSH" protocols="tcp" to-ports="22"/>
		<fwrule access="allow" direction="in" from-ips="all" name="RDP" protocols="tcp" to-ports="389"/>
	</global-fwrules>

	<models>
	
		<model imageId="ami-3c5f5748" instanceType="t1.micro" keyPairName="id_rsa_aws_webs" name="model-WEB" region="eu-west-1">
			<network-management method="ssh" port="22" mgmtNetworkDeviceAttribute="nat-ip"/>
			<fwrules>
				<fwrule access="allow" direction="in" from-ips="all" protocols="tcp" to-ports="80-443"/>
				<fwrule herit="./environment/global-fwrules/fwrule[@name='SSH']"/>
				<fwrule access="allow" direction="out" protocols="tcp" to-ips="ยง[string-join(melody:getManagementNetworkHost(//DB//instance),',')]ยง" to-ports="1421"/>
			</fwrules>
			<devices>
				<disk deleteOnTermination="true" device="/dev/sda1" rootDevice="true"/>
				<disk deleteOnTermination="true" device="/dev/sdb" size="1 G"/>
				<disk deleteOnTermination="true" device="/dev/sdc" size="2 G"/>
			</devices>
		</model>
	
		<model imageId="ami-3c5f5748" instanceType="t1.micro" keyPairName="id_rsa_aws_dbs" name="model-DB" region="eu-west-1">
			<network-management method="ssh" port="22" mgmtNetworkDeviceAttribute="nat-ip"/>
			<fwrules>
				<fwrule herit="./environment/global-fwrules/fwrule[@name='SSH']"/>
				<fwrule access="allow" direction="in" from-ips="ยง[string-join(melody:getManagementNetworkHost(//WEB//instance),',')]ยง" protocols="tcp" to-ports="1421"/>
			</fwrules>
			<devices>
				<disk deleteOnTermination="true" device="/dev/sda1" rootDevice="true"/>
				<disk deleteOnTermination="true" device="/dev/sdb" size="10 G"/>
				<disk deleteOnTermination="true" device="/dev/sdc" size="20 G"/>
			</devices>
		</model>
			
	</models>

	<instances>
		<WEB>
			<instance availabilityZone="a" herit="./environment/models/model[@name='model-WEB']" name="web-a01">
				<fwrules>
					<fwrule access="allow" direction="in" from-ips="all" to-ports="8080,8443" protocols="tcp"/>
				</fwrules>
				<devices>
					<disk deleteOnTermination="true" device="/dev/sdd" size="1 G"/>
				</devices>
				<network>
					<interface device="eth0"/>
				</network>
			</instance>	
			<instance availabilityZone="b" herit="./environment/models/model[@name='model-WEB']" name="web-b01">
				<network>
					<interface device="eth0"/>
				</network>
			</instance>	
			<instance availabilityZone="c" herit="./environment/models/model[@name='model-WEB']" name="web-c01">
				<network>
					<interface device="eth0"/>
				</network>
			</instance>	
		</WEB>
		<DB>
			<instance herit="./environment/models/model[@name='model-DB']" instanceType="m1.small" name="db-01"/>
		</DB>
	</instances>
	
</environment>